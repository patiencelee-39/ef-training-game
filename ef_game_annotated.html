<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŸ·è¡ŒåŠŸèƒ½è¨“ç·´éŠæˆ² - è©³ç´°è¨»è§£ç‰ˆ</title>

    <!-- 
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘  å€å¡Š 1ï¼šCSS æ¨£å¼ (æ§åˆ¶å¤–è§€)                                      â•‘
    â•‘  é€™è£¡æ±ºå®šäº†æ‰€æœ‰æ±è¥¿ã€Œé•·ä»€éº¼æ¨£å­ã€                                  â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    CSS çš„åŸºæœ¬èªæ³•ï¼š
    é¸æ“‡å™¨ {
        å±¬æ€§: å€¼;
    }
    
    ä¾‹å¦‚ï¼š
    .btn {              â† é¸æ“‡å™¨ï¼šæ‰€æœ‰ class="btn" çš„å…ƒç´ 
        color: white;   â† æ–‡å­—é¡è‰²è¨­ç‚ºç™½è‰²
        padding: 10px;  â† å…§éƒ¨ç•™ç™½ 10 åƒç´ 
    }
    -->
    <style>
        /* ----- åŸºæœ¬é‡ç½® ----- */
        /* æŠŠæ‰€æœ‰å…ƒç´ çš„é è¨­é‚Šè·æ­¸é›¶ï¼Œè®“æ’ç‰ˆæ›´å¥½æ§åˆ¶ */
        * {
            margin: 0;      /* å¤–é‚Šè·æ­¸é›¶ */
            padding: 0;     /* å…§é‚Šè·æ­¸é›¶ */
            box-sizing: border-box;  /* è®“å¯¬åº¦è¨ˆç®—åŒ…å«é‚Šæ¡† */
        }

        /* ----- æ•´å€‹é é¢çš„èƒŒæ™¯ ----- */
        body {
            /* å­—é«”ï¼šå…ˆå˜—è©¦å¾®è»Ÿæ­£é»‘é«”ï¼Œæ²’æœ‰å°±ç”¨ç³»çµ±é è¨­ */
            font-family: "Microsoft JhengHei", "å¾®è»Ÿæ­£é»‘é«”", sans-serif;
            
            /* æ¼¸å±¤èƒŒæ™¯ï¼šå¾å·¦ä¸Šåˆ°å³ä¸‹ï¼Œç´«è‰²æ¼¸å±¤ */
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            
            /* æœ€å°é«˜åº¦ = æ•´å€‹è¦–çª—é«˜åº¦ */
            min-height: 100vh;
            
            /* ç”¨ flexbox è®“å…§å®¹ç½®ä¸­ */
            display: flex;
            justify-content: center;  /* æ°´å¹³ç½®ä¸­ */
            align-items: center;      /* å‚ç›´ç½®ä¸­ */
            padding: 20px;
        }

        /* ----- éŠæˆ²ä¸»å®¹å™¨ï¼ˆç™½è‰²å¡ç‰‡ï¼‰----- */
        .game-container {
            background: white;
            border-radius: 20px;      /* åœ“è§’ */
            padding: 30px;            /* å…§éƒ¨ç•™ç™½ */
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);  /* é™°å½±æ•ˆæœ */
            max-width: 500px;         /* æœ€å¤§å¯¬åº¦ */
            width: 100%;
            text-align: center;       /* æ–‡å­—ç½®ä¸­ */
        }

        /* ----- æ¨™é¡Œæ¨£å¼ ----- */
        h1 {
            color: #333;              /* æ·±ç°è‰² */
            margin-bottom: 10px;
            font-size: 1.8em;         /* å­—é«”å¤§å°æ˜¯æ­£å¸¸çš„ 1.8 å€ */
        }

        /* ----- åˆºæ¿€å‘ˆç¾å€ï¼ˆåœ“å½¢å€åŸŸï¼‰----- */
        .stimulus {
            width: 120px;
            height: 120px;
            border-radius: 50%;       /* 50% = è®Šæˆåœ“å½¢ */
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 3em;           /* å¤§å­—é«”é¡¯ç¤º emoji */
            margin: 20px 0;
            transition: all 0.3s ease;  /* è®ŠåŒ–æ™‚æœ‰ 0.3 ç§’çš„éæ¸¡å‹•ç•« */
        }

        /* Go åˆºæ¿€ï¼ˆæ˜Ÿæ˜Ÿï¼‰çš„æ¨£å¼ - ç¶ è‰²èƒŒæ™¯ */
        .stimulus.go {
            background: #4CAF50;      /* ç¶ è‰² */
            color: white;
            animation: pulse 0.5s ease;  /* å¥—ç”¨ pulse å‹•ç•« */
        }

        /* No-Go åˆºæ¿€ï¼ˆå‰å‰ï¼‰çš„æ¨£å¼ - ç´…è‰²èƒŒæ™¯ */
        .stimulus.nogo {
            background: #f44336;      /* ç´…è‰² */
            color: white;
            animation: pulse 0.5s ease;
        }

        /* ä¸­æ€§ç‹€æ…‹ï¼ˆå•è™Ÿï¼‰- ç°è‰²èƒŒæ™¯ */
        .stimulus.neutral {
            background: #ddd;
            color: #999;
        }

        /* å®šç¾© pulse å‹•ç•«ï¼šå¾å°è®Šå¤§å†æ¢å¾© */
        @keyframes pulse {
            0% { transform: scale(0.8); opacity: 0; }   /* é–‹å§‹ï¼š80% å¤§å°ï¼Œé€æ˜ */
            50% { transform: scale(1.1); }              /* ä¸­é–“ï¼š110% å¤§å° */
            100% { transform: scale(1); opacity: 1; }   /* çµæŸï¼šæ­£å¸¸å¤§å°ï¼Œä¸é€æ˜ */
        }

        /* ----- æŒ‰éˆ•åŸºæœ¬æ¨£å¼ ----- */
        .btn {
            padding: 15px 40px;       /* ä¸Šä¸‹ 15pxï¼Œå·¦å³ 40px */
            font-size: 1.2em;
            border: none;             /* ç„¡é‚Šæ¡† */
            border-radius: 10px;      /* åœ“è§’ */
            cursor: pointer;          /* æ»‘é¼ è®Šæˆæ‰‹æŒ‡ */
            transition: all 0.3s ease;
            margin: 10px;
        }

        /* ä¸»è¦æŒ‰éˆ•ï¼ˆç´«è‰²æ¼¸å±¤ï¼‰*/
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        /* æ»‘é¼ ç§»ä¸Šå»æ™‚çš„æ•ˆæœ */
        .btn-primary:hover {
            transform: translateY(-3px);  /* å¾€ä¸Šç§»å‹• 3px */
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.4);  /* åŠ æ·±é™°å½± */
        }

        /* åæ‡‰æŒ‰éˆ•ï¼ˆç¶ è‰²ï¼Œæ›´å¤§ï¼‰*/
        .btn-action {
            background: #4CAF50;
            color: white;
            font-size: 1.5em;
            padding: 20px 60px;
        }

        /* ----- å›é¥‹è¨Šæ¯æ¨£å¼ ----- */
        .feedback {
            font-size: 1.5em;
            font-weight: bold;
            margin: 15px 0;
            min-height: 40px;         /* ä¿ç•™ç©ºé–“ï¼Œé¿å…ç‰ˆé¢è·³å‹• */
        }

        .feedback.correct {
            color: #4CAF50;           /* æ­£ç¢º = ç¶ è‰² */
        }

        .feedback.incorrect {
            color: #f44336;           /* éŒ¯èª¤ = ç´…è‰² */
        }

        /* ----- é€²åº¦æ¢ ----- */
        .progress-bar {
            width: 100%;
            height: 10px;
            background: #e0e0e0;      /* ç°è‰²åº• */
            border-radius: 5px;
            overflow: hidden;         /* è¶…å‡ºéƒ¨åˆ†éš±è— */
            margin: 15px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            transition: width 0.3s ease;  /* å¯¬åº¦è®ŠåŒ–æœ‰å‹•ç•« */
        }

        /* ----- åˆ†æ•¸æ¿ ----- */
        .score-board {
            display: flex;
            justify-content: space-around;
            margin: 20px 0;
        }

        .score-item {
            background: #f0f0f0;
            padding: 15px 25px;
            border-radius: 10px;
        }

        .score-item .label {
            font-size: 0.8em;
            color: #666;
        }

        .score-item .value {
            font-size: 1.8em;
            font-weight: bold;
            color: #333;
        }

        /* ----- éŠæˆ²å€åŸŸ ----- */
        .game-area {
            background: #f5f5f5;
            border-radius: 15px;
            padding: 30px;
            margin: 20px 0;
            min-height: 200px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        /* ----- èªªæ˜å€å¡Š ----- */
        .instruction {
            background: #e3f2fd;      /* æ·ºè—è‰²èƒŒæ™¯ */
            border-left: 4px solid #2196F3;  /* å·¦é‚Šè—è‰²é‚Šæ¢ */
            padding: 15px;
            margin: 15px 0;
            text-align: left;
            border-radius: 0 10px 10px 0;
        }

        .instruction h3 {
            color: #1976D2;
            margin-bottom: 8px;
        }

        /* ----- çµæœé é¢ ----- */
        .results {
            text-align: left;
        }

        .result-item {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid #eee;
        }

        /* ----- æ•¸æ“šè¡¨æ ¼ ----- */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.85em;
            margin-top: 10px;
        }

        .data-table th, .data-table td {
            padding: 8px;
            border: 1px solid #ddd;
            text-align: center;
        }

        .data-table th {
            background: #f5f5f5;
        }

        /* ----- éš±è—å…ƒç´ çš„ class ----- */
        /* åŠ ä¸Šé€™å€‹ class çš„å…ƒç´ æœƒè¢«éš±è— */
        .hidden {
            display: none !important;
        }
    </style>
</head>

<body>
    <!-- 
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘  å€å¡Š 2ï¼šHTML çµæ§‹ (ç•«é¢å…§å®¹)                                      â•‘
    â•‘  é€™è£¡æ±ºå®šäº†ç•«é¢ä¸Šã€Œæœ‰å“ªäº›æ±è¥¿ã€                                    â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
    HTML çš„åŸºæœ¬èªæ³•ï¼š
    <æ¨™ç±¤ å±¬æ€§="å€¼">å…§å®¹</æ¨™ç±¤>
    
    é‡è¦æ¦‚å¿µï¼š
    - id="xxx"    â†’ å”¯ä¸€è­˜åˆ¥ç¢¼ï¼Œç”¨ document.getElementById('xxx') å–å¾—
    - class="xxx" â†’ æ¨£å¼é¡åˆ¥ï¼Œå¯ä»¥é‡è¤‡ä½¿ç”¨
    - onclick="å‡½æ•¸()" â†’ é»æ“Šæ™‚åŸ·è¡ŒæŸå€‹å‡½æ•¸
    -->

    <div class="game-container">
        
        <!-- ===== ç•«é¢ 1ï¼šé–‹å§‹ç•«é¢ ===== -->
        <!-- ä¸€é–‹å§‹é¡¯ç¤ºï¼Œé»ã€Œé–‹å§‹éŠæˆ²ã€å¾Œæœƒè¢«éš±è— -->
        <div id="startScreen">
            <h1>ğŸ§  åŸ·è¡ŒåŠŸèƒ½è¨“ç·´éŠæˆ²</h1>
            <p class="subtitle">å·¥ä½œè¨˜æ†¶ + æŠ‘åˆ¶æ§åˆ¶ è¨“ç·´åŸå‹</p>
            
            <!-- éŠæˆ²è¦å‰‡èªªæ˜ -->
            <div class="instruction">
                <h3>ğŸ“‹ éŠæˆ²è¦å‰‡</h3>
                <p>
                    <strong>1. çœ‹åˆ° â­ æ˜Ÿæ˜Ÿ â†’ æŒ‰ä¸‹æŒ‰éˆ•ï¼</strong><br>
                    <strong>2. çœ‹åˆ° âŒ å‰å‰ â†’ ä¸è¦æŒ‰ï¼å¿ä½ï¼</strong><br>
                    <strong>3. è¨˜ä½å‰ä¸€å€‹æ˜¯ä»€éº¼</strong>ï¼ˆä¹‹å¾Œæœƒå•ä½ ï¼‰
                </p>
            </div>

            <!-- è¨“ç·´ç›®æ¨™èªªæ˜ -->
            <div class="instruction">
                <h3>ğŸ¯ è¨“ç·´ç›®æ¨™</h3>
                <p>
                    â€¢ <strong>å·¥ä½œè¨˜æ†¶</strong>ï¼šè¨˜ä½çœ‹éçš„åœ–æ¡ˆ<br>
                    â€¢ <strong>æŠ‘åˆ¶æ§åˆ¶</strong>ï¼šçœ‹åˆ°å‰å‰è¦å¿ä½ä¸æŒ‰
                </p>
            </div>

            <!-- é»æ“Šé€™å€‹æŒ‰éˆ•æœƒåŸ·è¡Œ startGame() å‡½æ•¸ -->
            <button class="btn btn-primary" onclick="startGame()">é–‹å§‹éŠæˆ²</button>
        </div>

        <!-- ===== ç•«é¢ 2ï¼šéŠæˆ²é€²è¡Œä¸­ ===== -->
        <!-- ä¸€é–‹å§‹æ˜¯éš±è—çš„ (class="hidden")ï¼Œé–‹å§‹éŠæˆ²å¾Œæ‰é¡¯ç¤º -->
        <div id="gameScreen" class="hidden">
            <!-- é¡Œè™Ÿé¡¯ç¤º -->
            <h2>ç¬¬ <span id="currentTrial">1</span> / <span id="totalTrials">10</span> é¡Œ</h2>
            
            <!-- é€²åº¦æ¢ -->
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 0%"></div>
            </div>

            <!-- åˆ†æ•¸æ¿ -->
            <div class="score-board">
                <div class="score-item">
                    <div class="label">æ­£ç¢º</div>
                    <div class="value" id="correctCount">0</div>
                </div>
                <div class="score-item">
                    <div class="label">éŒ¯èª¤</div>
                    <div class="value" id="errorCount">0</div>
                </div>
            </div>

            <!-- éŠæˆ²å€åŸŸï¼šé¡¯ç¤ºåˆºæ¿€å’Œå›é¥‹ -->
            <div class="game-area">
                <!-- åˆºæ¿€å‘ˆç¾å€ï¼ˆåœ“å½¢ï¼Œæœƒé¡¯ç¤ºæ˜Ÿæ˜Ÿæˆ–å‰å‰ï¼‰-->
                <div class="stimulus neutral" id="stimulus">?</div>
                <!-- å›é¥‹è¨Šæ¯ï¼ˆæ­£ç¢º/éŒ¯èª¤ï¼‰-->
                <div class="feedback" id="feedback"></div>
            </div>

            <!-- åæ‡‰æŒ‰éˆ• -->
            <button class="btn btn-action" id="responseBtn" onclick="recordResponse()">
                æŒ‰é€™è£¡ï¼
            </button>
        </div>

        <!-- ===== ç•«é¢ 3ï¼šè¨˜æ†¶æ¸¬è©¦ ===== -->
        <div id="memoryTestScreen" class="hidden">
            <h2>ğŸ¤” è¨˜æ†¶æ¸¬è©¦</h2>
            <p style="margin: 20px 0; font-size: 1.1em;">
                å‰›æ‰<strong>å€’æ•¸ç¬¬äºŒå€‹</strong>åœ–æ¡ˆæ˜¯ä»€éº¼ï¼Ÿ
            </p>
            
            <!-- å…©å€‹é¸é …æŒ‰éˆ• -->
            <div style="display: flex; justify-content: center; gap: 20px; margin: 30px 0;">
                <button class="btn btn-primary" onclick="checkMemory('star')" 
                        style="font-size: 2em; padding: 20px 40px;">â­</button>
                <button class="btn btn-primary" onclick="checkMemory('cross')" 
                        style="font-size: 2em; padding: 20px 40px;">âŒ</button>
            </div>
        </div>

        <!-- ===== ç•«é¢ 4ï¼šçµæœé¡¯ç¤º ===== -->
        <div id="resultScreen" class="hidden">
            <h2>ğŸ“Š éŠæˆ²çµæœ</h2>
            
            <!-- çµ±è¨ˆæ•¸æ“š -->
            <div class="results">
                <div class="result-item">
                    <span class="label">ç¸½é¡Œæ•¸</span>
                    <span class="value" id="resultTotal">-</span>
                </div>
                <div class="result-item">
                    <span class="label">æ­£ç¢ºæ¬¡æ•¸</span>
                    <span class="value" id="resultCorrect">-</span>
                </div>
                <div class="result-item">
                    <span class="label">æ­£ç¢ºç‡</span>
                    <span class="value" id="resultAccuracy">-</span>
                </div>
                <div class="result-item">
                    <span class="label">å¹³å‡åæ‡‰æ™‚é–“</span>
                    <span class="value" id="resultRT">-</span>
                </div>
                <div class="result-item">
                    <span class="label">æŠ‘åˆ¶æˆåŠŸç‡</span>
                    <span class="value" id="resultInhibition">-</span>
                </div>
                <div class="result-item">
                    <span class="label">è¨˜æ†¶æ¸¬è©¦</span>
                    <span class="value" id="resultMemory">-</span>
                </div>
            </div>

            <!-- è©³ç´°æ•¸æ“šè¡¨æ ¼ -->
            <div class="data-section" style="margin-top: 20px; text-align: left;">
                <h3>ğŸ“ è©³ç´°æ•¸æ“šï¼ˆå¯åŒ¯å‡ºï¼‰</h3>
                <table class="data-table" id="dataTable">
                    <thead>
                        <tr>
                            <th>é¡Œè™Ÿ</th>
                            <th>é¡å‹</th>
                            <th>åæ‡‰</th>
                            <th>æ­£ç¢º</th>
                            <th>åæ‡‰æ™‚é–“(ms)</th>
                        </tr>
                    </thead>
                    <tbody id="dataBody">
                        <!-- JavaScript æœƒå‹•æ…‹å¡«å…¥å…§å®¹ -->
                    </tbody>
                </table>
                <button class="btn btn-primary" onclick="exportData()" style="margin-top: 15px;">
                    åŒ¯å‡º CSV
                </button>
            </div>

            <button class="btn btn-primary" onclick="restartGame()" style="margin-top: 20px;">
                å†ç©ä¸€æ¬¡
            </button>
        </div>
    </div>

    <!-- 
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘  å€å¡Š 3ï¼šJavaScript é‚è¼¯ (ç¨‹å¼é‹ä½œ)                               â•‘
    â•‘  é€™è£¡æ±ºå®šäº†éŠæˆ²ã€Œæ€éº¼é‹ä½œã€                                       â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    -->
    <script>
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // å€å¡Š 3-1ï¼šéŠæˆ²è¨­å®š (å¯ä»¥ä¿®æ”¹é€™è£¡ä¾†èª¿æ•´éŠæˆ²åƒæ•¸)
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        const CONFIG = {
            totalTrials: 10,           // ç¸½é¡Œæ•¸ï¼ˆå¯æ”¹æˆ 15, 20 ç­‰ï¼‰
            stimulusDuration: 1500,    // åˆºæ¿€å‘ˆç¾æ™‚é–“ï¼Œå–®ä½æ˜¯æ¯«ç§’ï¼ˆ1500 = 1.5 ç§’ï¼‰
            interTrialInterval: 1000,  // é¡Œç›®ä¹‹é–“çš„é–“éš”ï¼ˆ1000 = 1 ç§’ï¼‰
            goRatio: 0.7               // Go åˆºæ¿€çš„æ¯”ä¾‹ï¼ˆ0.7 = 70% æ˜Ÿæ˜Ÿ, 30% å‰å‰ï¼‰
        };

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // å€å¡Š 3-2ï¼šéŠæˆ²ç‹€æ…‹ (å„²å­˜éŠæˆ²é€²è¡Œä¸­çš„æ‰€æœ‰è³‡æ–™)
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        /*
         * é€™æ˜¯ä¸€å€‹ã€Œç‰©ä»¶ã€(object)ï¼Œç”¨ä¾†å­˜æ”¾éŠæˆ²çš„å„ç¨®ç‹€æ…‹
         * æƒ³åƒæˆä¸€å€‹è³‡æ–™å¤¾ï¼Œè£¡é¢æœ‰å¾ˆå¤šå°æ ¼å­å­˜ä¸åŒçš„è³‡æ–™
         */
        let gameState = {
            currentTrial: 0,           // ç›®å‰æ˜¯ç¬¬å¹¾é¡Œ
            correctCount: 0,           // ç­”å°å¹¾é¡Œ
            errorCount: 0,             // ç­”éŒ¯å¹¾é¡Œ
            trialData: [],             // æ¯ä¸€é¡Œçš„è©³ç´°æ•¸æ“šï¼ˆé™£åˆ—ï¼‰
            stimulusSequence: [],      // åˆºæ¿€çš„é †åºï¼ˆä¾‹å¦‚ï¼š['go','nogo','go','go',...]ï¼‰
            currentStimulus: null,     // ç›®å‰é€™é¡Œæ˜¯ 'go' é‚„æ˜¯ 'nogo'
            stimulusStartTime: null,   // åˆºæ¿€å‡ºç¾çš„æ™‚é–“é»ï¼ˆç”¨ä¾†è¨ˆç®—åæ‡‰æ™‚é–“ï¼‰
            responded: false,          // é€™ä¸€é¡Œæ˜¯å¦å·²ç¶“æŒ‰éæŒ‰éˆ•
            gameActive: false          // éŠæˆ²æ˜¯å¦æ­£åœ¨é€²è¡Œä¸­
        };

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // å€å¡Š 3-3ï¼šç”¢ç”Ÿåˆºæ¿€åºåˆ—
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        /*
         * é€™å€‹å‡½æ•¸æœƒç”¢ç”Ÿä¸€å€‹éš¨æ©Ÿçš„åˆºæ¿€åºåˆ—
         * ä¾‹å¦‚ï¼š['go', 'go', 'nogo', 'go', 'nogo', 'go', ...]
         */
        function generateSequence() {
            const sequence = [];  // å»ºç«‹ä¸€å€‹ç©ºé™£åˆ—
            
            // è¨ˆç®— Go å’Œ No-Go å„éœ€è¦å¹¾é¡Œ
            // Math.floor() æ˜¯ã€Œç„¡æ¢ä»¶æ¨å»ã€ï¼Œä¾‹å¦‚ 7.5 æœƒè®Šæˆ 7
            const goCount = Math.floor(CONFIG.totalTrials * CONFIG.goRatio);
            const nogoCount = CONFIG.totalTrials - goCount;
            
            // æŠŠ 'go' åŠ å…¥é™£åˆ— goCount æ¬¡
            for (let i = 0; i < goCount; i++) {
                sequence.push('go');
            }
            
            // æŠŠ 'nogo' åŠ å…¥é™£åˆ— nogoCount æ¬¡
            for (let i = 0; i < nogoCount; i++) {
                sequence.push('nogo');
            }
            
            // éš¨æ©Ÿæ‰“äº‚é™£åˆ—ï¼ˆFisher-Yates æ´—ç‰Œæ¼”ç®—æ³•ï¼‰
            // é€™æ¨£æ¯æ¬¡ç©éŠæˆ²ï¼Œé †åºéƒ½æœƒä¸ä¸€æ¨£
            for (let i = sequence.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                // äº¤æ›ä½ç½® i å’Œä½ç½® j çš„å…ƒç´ 
                [sequence[i], sequence[j]] = [sequence[j], sequence[i]];
            }
            
            return sequence;  // å›å‚³æ‰“äº‚å¾Œçš„åºåˆ—
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // å€å¡Š 3-4ï¼šé–‹å§‹éŠæˆ²
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        /*
         * ç•¶ç©å®¶é»æ“Šã€Œé–‹å§‹éŠæˆ²ã€æŒ‰éˆ•æ™‚ï¼ŒæœƒåŸ·è¡Œé€™å€‹å‡½æ•¸
         */
        function startGame() {
            // é‡ç½®æ‰€æœ‰éŠæˆ²ç‹€æ…‹
            gameState = {
                currentTrial: 0,
                correctCount: 0,
                errorCount: 0,
                trialData: [],
                stimulusSequence: generateSequence(),  // ç”¢ç”Ÿæ–°çš„éš¨æ©Ÿåºåˆ—
                currentStimulus: null,
                stimulusStartTime: null,
                responded: false,
                gameActive: true
            };

            // åˆ‡æ›ç•«é¢ï¼šéš±è—é–‹å§‹ç•«é¢ï¼Œé¡¯ç¤ºéŠæˆ²ç•«é¢
            // classList.add('hidden') = åŠ ä¸Š 'hidden' é€™å€‹ class
            // classList.remove('hidden') = ç§»é™¤ 'hidden' é€™å€‹ class
            document.getElementById('startScreen').classList.add('hidden');
            document.getElementById('gameScreen').classList.remove('hidden');
            
            // æ›´æ–°ç¸½é¡Œæ•¸é¡¯ç¤º
            document.getElementById('totalTrials').textContent = CONFIG.totalTrials;

            // 1 ç§’å¾Œé–‹å§‹ç¬¬ä¸€é¡Œ
            // setTimeout(å‡½æ•¸, æ™‚é–“) = åœ¨æŒ‡å®šæ™‚é–“å¾ŒåŸ·è¡Œå‡½æ•¸
            setTimeout(nextTrial, 1000);
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // å€å¡Š 3-5ï¼šé€²å…¥ä¸‹ä¸€é¡Œ
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        function nextTrial() {
            // å¦‚æœå·²ç¶“åšå®Œæ‰€æœ‰é¡Œç›®ï¼Œå°±é€²å…¥è¨˜æ†¶æ¸¬è©¦
            if (gameState.currentTrial >= CONFIG.totalTrials) {
                showMemoryTest();
                return;  // çµæŸé€™å€‹å‡½æ•¸ï¼Œä¸åŸ·è¡Œä¸‹é¢çš„ç¨‹å¼ç¢¼
            }

            // é¡Œè™Ÿ +1
            gameState.currentTrial++;
            gameState.responded = false;  // é‡ç½®ã€Œå·²åæ‡‰ã€ç‹€æ…‹
            
            // === æ›´æ–°ç•«é¢ä¸Šçš„è³‡è¨Š ===
            
            // æ›´æ–°é¡Œè™Ÿé¡¯ç¤º
            document.getElementById('currentTrial').textContent = gameState.currentTrial;
            
            // æ›´æ–°é€²åº¦æ¢å¯¬åº¦ï¼ˆç™¾åˆ†æ¯”ï¼‰
            const progressPercent = (gameState.currentTrial / CONFIG.totalTrials * 100);
            document.getElementById('progressFill').style.width = progressPercent + '%';
            
            // æ¸…ç©ºå›é¥‹è¨Šæ¯
            document.getElementById('feedback').textContent = '';
            document.getElementById('feedback').className = 'feedback';

            // === å‘ˆç¾åˆºæ¿€ ===
            
            // å–å¾—é€™ä¸€é¡Œçš„åˆºæ¿€é¡å‹ï¼ˆå¾åºåˆ—ä¸­æŒ‰é †åºå–å‡ºï¼‰
            // æ³¨æ„ï¼šé™£åˆ—æ˜¯å¾ 0 é–‹å§‹ç·¨è™Ÿï¼Œæ‰€ä»¥è¦ -1
            const stimulusType = gameState.stimulusSequence[gameState.currentTrial - 1];
            gameState.currentStimulus = stimulusType;
            
            // å–å¾—åˆºæ¿€å…ƒç´ ï¼Œæ”¹è®Šå®ƒçš„æ¨£å¼å’Œå…§å®¹
            const stimulusEl = document.getElementById('stimulus');
            stimulusEl.className = 'stimulus ' + stimulusType;  // ä¾‹å¦‚ 'stimulus go'
            stimulusEl.textContent = stimulusType === 'go' ? 'â­' : 'âŒ';
            // ä¸Šé¢é€™è¡Œæ˜¯ã€Œä¸‰å…ƒé‹ç®—å­ã€ï¼Œç›¸ç•¶æ–¼ï¼š
            // if (stimulusType === 'go') {
            //     stimulusEl.textContent = 'â­';
            // } else {
            //     stimulusEl.textContent = 'âŒ';
            // }
            
            // è¨˜éŒ„åˆºæ¿€å‡ºç¾çš„æ™‚é–“ï¼ˆç”¨ä¾†è¨ˆç®—åæ‡‰æ™‚é–“ï¼‰
            gameState.stimulusStartTime = Date.now();

            // === è¨­å®šæ™‚é–“é™åˆ¶ ===
            
            // å¦‚æœè¶…éæ™‚é–“é‚„æ²’åæ‡‰ï¼Œå°±ç•¶ä½œã€Œæ²’æœ‰æŒ‰ã€
            setTimeout(() => {
                // é€™æ˜¯ä¸€å€‹ã€Œç®­é ­å‡½æ•¸ã€ï¼Œæœƒåœ¨æŒ‡å®šæ™‚é–“å¾ŒåŸ·è¡Œ
                if (!gameState.responded && gameState.gameActive) {
                    // å¦‚æœé‚„æ²’åæ‡‰ï¼Œè€Œä¸”éŠæˆ²é‚„åœ¨é€²è¡Œä¸­
                    processResponse(false);  // è™•ç†ã€Œæ²’æœ‰æŒ‰ã€çš„æƒ…æ³
                }
            }, CONFIG.stimulusDuration);
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // å€å¡Š 3-6ï¼šè¨˜éŒ„ç©å®¶çš„åæ‡‰
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        /*
         * ç•¶ç©å®¶é»æ“Šã€ŒæŒ‰é€™è£¡ï¼ã€æŒ‰éˆ•æ™‚ï¼ŒæœƒåŸ·è¡Œé€™å€‹å‡½æ•¸
         */
        function recordResponse() {
            // å¦‚æœéŠæˆ²æ²’åœ¨é€²è¡Œï¼Œæˆ–é€™é¡Œå·²ç¶“æŒ‰éäº†ï¼Œå°±ä¸è™•ç†
            if (!gameState.gameActive || gameState.responded) {
                return;
            }
            
            gameState.responded = true;  // æ¨™è¨˜ç‚ºã€Œå·²åæ‡‰ã€
            
            // è¨ˆç®—åæ‡‰æ™‚é–“ = ç¾åœ¨æ™‚é–“ - åˆºæ¿€å‡ºç¾æ™‚é–“
            const responseTime = Date.now() - gameState.stimulusStartTime;
            
            // è™•ç†é€™å€‹åæ‡‰
            processResponse(true, responseTime);
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // å€å¡Š 3-7ï¼šè™•ç†åæ‡‰ï¼ˆåˆ¤æ–·å°éŒ¯ã€è¨˜éŒ„æ•¸æ“šï¼‰
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        /*
         * didRespond: ç©å®¶æ˜¯å¦æœ‰æŒ‰æŒ‰éˆ•ï¼ˆtrue/falseï¼‰
         * responseTime: åæ‡‰æ™‚é–“ï¼ˆæ¯«ç§’ï¼‰ï¼Œå¦‚æœæ²’æŒ‰å°±æ˜¯ null
         */
        function processResponse(didRespond, responseTime = null) {
            const stimulusType = gameState.currentStimulus;
            let isCorrect = false;
            
            // === åˆ¤æ–·æ­£ç¢ºèˆ‡å¦ ===
            // Go åˆºæ¿€ï¼ˆæ˜Ÿæ˜Ÿï¼‰ï¼šè¦æŒ‰æ‰å°
            // No-Go åˆºæ¿€ï¼ˆå‰å‰ï¼‰ï¼šä¸æŒ‰æ‰å°
            
            if (stimulusType === 'go' && didRespond) {
                isCorrect = true;  // æ˜Ÿæ˜Ÿ + æœ‰æŒ‰ = æ­£ç¢º âœ“
            } else if (stimulusType === 'nogo' && !didRespond) {
                isCorrect = true;  // å‰å‰ + æ²’æŒ‰ = æ­£ç¢º âœ“ï¼ˆæˆåŠŸæŠ‘åˆ¶ï¼‰
            }
            // å…¶ä»–æƒ…æ³éƒ½æ˜¯éŒ¯èª¤ï¼š
            // - æ˜Ÿæ˜Ÿ + æ²’æŒ‰ = å¤ªæ…¢äº†
            // - å‰å‰ + æœ‰æŒ‰ = æŠ‘åˆ¶å¤±æ•—

            // === æ›´æ–°è¨ˆæ•¸ ===
            if (isCorrect) {
                gameState.correctCount++;
            } else {
                gameState.errorCount++;
            }

            // === è¨˜éŒ„é€™ä¸€é¡Œçš„è©³ç´°æ•¸æ“š ===
            // push() æ˜¯æŠŠæ–°å…ƒç´ åŠ åˆ°é™£åˆ—çš„æœ€å¾Œé¢
            gameState.trialData.push({
                trial: gameState.currentTrial,    // é¡Œè™Ÿ
                type: stimulusType,               // 'go' æˆ– 'nogo'
                responded: didRespond,            // æœ‰æ²’æœ‰æŒ‰
                correct: isCorrect,               // å°ä¸å°
                rt: responseTime                  // åæ‡‰æ™‚é–“
            });

            // === é¡¯ç¤ºå›é¥‹è¨Šæ¯ ===
            const feedbackEl = document.getElementById('feedback');
            if (isCorrect) {
                feedbackEl.textContent = 'âœ“ æ­£ç¢ºï¼';
                feedbackEl.className = 'feedback correct';
            } else {
                // æ ¹æ“šéŒ¯èª¤é¡å‹é¡¯ç¤ºä¸åŒè¨Šæ¯
                if (stimulusType === 'go' && !didRespond) {
                    feedbackEl.textContent = 'âœ— å¤ªæ…¢äº†ï¼è¦æŒ‰æŒ‰éˆ•ï¼';
                } else if (stimulusType === 'nogo' && didRespond) {
                    feedbackEl.textContent = 'âœ— è¦å¿ä½ä¸æŒ‰ï¼';
                }
                feedbackEl.className = 'feedback incorrect';
            }

            // === æ›´æ–°åˆ†æ•¸é¡¯ç¤º ===
            document.getElementById('correctCount').textContent = gameState.correctCount;
            document.getElementById('errorCount').textContent = gameState.errorCount;

            // === æ¸…é™¤åˆºæ¿€ï¼ˆé¡¯ç¤ºå•è™Ÿï¼‰===
            const stimulusEl = document.getElementById('stimulus');
            stimulusEl.className = 'stimulus neutral';
            stimulusEl.textContent = '?';

            // === é€²å…¥ä¸‹ä¸€é¡Œ ===
            setTimeout(nextTrial, CONFIG.interTrialInterval);
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // å€å¡Š 3-8ï¼šè¨˜æ†¶æ¸¬è©¦
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        function showMemoryTest() {
            gameState.gameActive = false;  // åœæ­¢éŠæˆ²
            
            // åˆ‡æ›ç•«é¢
            document.getElementById('gameScreen').classList.add('hidden');
            document.getElementById('memoryTestScreen').classList.remove('hidden');
        }

        /*
         * æª¢æŸ¥è¨˜æ†¶æ¸¬è©¦çš„ç­”æ¡ˆ
         * answer: 'star' æˆ– 'cross'
         */
        function checkMemory(answer) {
            // å–å¾—å€’æ•¸ç¬¬äºŒå€‹åˆºæ¿€çš„é¡å‹
            // CONFIG.totalTrials - 2 æ˜¯å› ç‚ºé™£åˆ—å¾ 0 é–‹å§‹ï¼Œè€Œä¸”æ˜¯ã€Œå€’æ•¸ç¬¬äºŒå€‹ã€
            const secondLastStimulus = gameState.stimulusSequence[CONFIG.totalTrials - 2];
            
            // åˆ¤æ–·æ­£ç¢ºç­”æ¡ˆ
            const correctAnswer = secondLastStimulus === 'go' ? 'star' : 'cross';
            
            // è¨˜éŒ„æ˜¯å¦ç­”å°
            gameState.memoryCorrect = (answer === correctAnswer);
            
            // é¡¯ç¤ºçµæœ
            showResults();
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // å€å¡Š 3-9ï¼šé¡¯ç¤ºçµæœ
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        function showResults() {
            // åˆ‡æ›ç•«é¢
            document.getElementById('memoryTestScreen').classList.add('hidden');
            document.getElementById('resultScreen').classList.remove('hidden');

            // === è¨ˆç®—çµ±è¨ˆæ•¸æ“š ===
            
            // ç¯©é¸å‡º Go è©¦é¡Œå’Œ No-Go è©¦é¡Œ
            // filter() æœƒæ ¹æ“šæ¢ä»¶ç¯©é¸å‡ºç¬¦åˆçš„å…ƒç´ 
            const goTrials = gameState.trialData.filter(t => t.type === 'go');
            const nogoTrials = gameState.trialData.filter(t => t.type === 'nogo');
            
            // è¨ˆç®— Go è©¦é¡Œçš„å¹³å‡åæ‡‰æ™‚é–“
            // åªè¨ˆç®—ã€Œæ­£ç¢ºä¸”æœ‰æŒ‰ã€çš„è©¦é¡Œ
            const goCorrectTrials = goTrials.filter(t => t.correct && t.rt);
            let avgRT = '-';
            if (goCorrectTrials.length > 0) {
                // reduce() æœƒæŠŠé™£åˆ—ä¸­æ‰€æœ‰å…ƒç´ åŠ ç¸½èµ·ä¾†
                const totalRT = goCorrectTrials.reduce((sum, t) => sum + t.rt, 0);
                avgRT = Math.round(totalRT / goCorrectTrials.length);
            }

            // è¨ˆç®—æŠ‘åˆ¶æˆåŠŸç‡ï¼ˆNo-Go è©¦é¡Œçš„æ­£ç¢ºç‡ï¼‰
            let inhibitionRate = '-';
            if (nogoTrials.length > 0) {
                const correctNoGo = nogoTrials.filter(t => t.correct).length;
                inhibitionRate = Math.round(correctNoGo / nogoTrials.length * 100);
            }

            // === é¡¯ç¤ºçµæœ ===
            document.getElementById('resultTotal').textContent = CONFIG.totalTrials + ' é¡Œ';
            document.getElementById('resultCorrect').textContent = gameState.correctCount + ' æ¬¡';
            document.getElementById('resultAccuracy').textContent = 
                Math.round(gameState.correctCount / CONFIG.totalTrials * 100) + '%';
            document.getElementById('resultRT').textContent = avgRT + ' ms';
            document.getElementById('resultInhibition').textContent = inhibitionRate + '%';
            document.getElementById('resultMemory').textContent = 
                gameState.memoryCorrect ? 'âœ“ æ­£ç¢º' : 'âœ— éŒ¯èª¤';

            // === å¡«å…¥è©³ç´°æ•¸æ“šè¡¨æ ¼ ===
            const tbody = document.getElementById('dataBody');
            tbody.innerHTML = '';  // æ¸…ç©ºè¡¨æ ¼
            
            // ç”¨è¿´åœˆæŠŠæ¯ä¸€é¡Œçš„æ•¸æ“šåŠ å…¥è¡¨æ ¼
            gameState.trialData.forEach(trial => {
                const row = document.createElement('tr');  // å»ºç«‹ä¸€å€‹æ–°çš„ <tr> å…ƒç´ 
                row.innerHTML = `
                    <td>${trial.trial}</td>
                    <td>${trial.type === 'go' ? 'â­ Go' : 'âŒ No-Go'}</td>
                    <td>${trial.responded ? 'æœ‰æŒ‰' : 'æ²’æŒ‰'}</td>
                    <td style="color: ${trial.correct ? 'green' : 'red'}">
                        ${trial.correct ? 'âœ“' : 'âœ—'}
                    </td>
                    <td>${trial.rt || '-'}</td>
                `;
                tbody.appendChild(row);  // æŠŠé€™ä¸€åˆ—åŠ åˆ°è¡¨æ ¼ä¸­
            });
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // å€å¡Š 3-10ï¼šåŒ¯å‡ºæ•¸æ“šï¼ˆCSV æ ¼å¼ï¼‰
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        function exportData() {
            // CSV çš„ç¬¬ä¸€è¡Œæ˜¯æ¨™é¡Œ
            let csv = 'é¡Œè™Ÿ,é¡å‹,åæ‡‰,æ­£ç¢º,åæ‡‰æ™‚é–“(ms)\n';
            
            // æŠŠæ¯ä¸€é¡Œçš„æ•¸æ“šåŠ å…¥ CSV
            gameState.trialData.forEach(trial => {
                csv += `${trial.trial},`;
                csv += `${trial.type},`;
                csv += `${trial.responded ? 'æœ‰æŒ‰' : 'æ²’æŒ‰'},`;
                csv += `${trial.correct ? 'æ­£ç¢º' : 'éŒ¯èª¤'},`;
                csv += `${trial.rt || ''}\n`;
            });

            // åŠ å…¥æ‘˜è¦çµ±è¨ˆ
            csv += '\næ‘˜è¦çµ±è¨ˆ\n';
            csv += `ç¸½æ­£ç¢ºç‡,${Math.round(gameState.correctCount / CONFIG.totalTrials * 100)}%\n`;
            csv += `è¨˜æ†¶æ¸¬è©¦,${gameState.memoryCorrect ? 'æ­£ç¢º' : 'éŒ¯èª¤'}\n`;

            // === å»ºç«‹ä¸‹è¼‰é€£çµ ===
            // Blob æ˜¯ä¸€ç¨®äºŒé€²ä½å¤§å‹ç‰©ä»¶ï¼Œç”¨ä¾†è™•ç†æª”æ¡ˆ
            // '\ufeff' æ˜¯ BOM æ¨™è¨˜ï¼Œè®“ Excel èƒ½æ­£ç¢ºé¡¯ç¤ºä¸­æ–‡
            const blob = new Blob(['\ufeff' + csv], { type: 'text/csv;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            
            // å»ºç«‹ä¸€å€‹éš±è—çš„ <a> é€£çµä¸¦é»æ“Šå®ƒ
            const a = document.createElement('a');
            a.href = url;
            a.download = `éŠæˆ²æ•¸æ“š_${new Date().toISOString().slice(0,10)}.csv`;
            a.click();  // è‡ªå‹•é»æ“Šï¼Œè§¸ç™¼ä¸‹è¼‰
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // å€å¡Š 3-11ï¼šé‡æ–°é–‹å§‹éŠæˆ²
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        function restartGame() {
            document.getElementById('resultScreen').classList.add('hidden');
            document.getElementById('startScreen').classList.remove('hidden');
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // å€å¡Š 3-12ï¼šéµç›¤å¿«æ·éµ
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        /*
         * ç›£è½éµç›¤æŒ‰éµäº‹ä»¶
         * è®“ç©å®¶å¯ä»¥ç”¨ç©ºç™½éµä»£æ›¿æ»‘é¼ é»æ“Š
         */
        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space' && gameState.gameActive) {
                e.preventDefault();  // é˜²æ­¢ç©ºç™½éµæ²å‹•é é¢
                recordResponse();    // åŸ·è¡Œå’Œé»æ“ŠæŒ‰éˆ•ä¸€æ¨£çš„å‹•ä½œ
            }
        });
    </script>
</body>
</html>
